<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
    <title>Stock Management</title>
    <h:outputStylesheet library="css" name="style.css"/>
</h:head>

<h:body>

    <ui:include src="/WEB-INF/templates/commonHeader.xhtml"/>


    <h:form id="create-form" class="center">
        <p:panel id="panel" header="Novo Produto">
            <h:panelGrid columns="2" cellpadding="9" class="center">
                <p:outputLabel for="discount" value="Desconto:"/>
                <p:spinner id="discount" required="true" value="#{createProduct.product.discount}" max="100" min="0" suffix="%">
                    <f:convertNumber integerOnly="true"/>
                </p:spinner>

                <p:outputLabel for="iva" value="IVA:"/>
                <p:spinner id="iva" required="true" value="#{createProduct.product.iva}" max="100" min="0" suffix="%">
                    <f:convertNumber integerOnly="true"/>
                </p:spinner>

                <p:outputLabel for="pvp" value="PVP:"/>
                <p:spinner id="pvp" required="true" value="#{createProduct.product.pvp}" min="0.00" suffix="€" stepFactor="0.25">
                    <f:convertNumber integerOnly="false" minFractionDigits="2" maxFractionDigits="2"/>
                </p:spinner>

                <p:outputLabel for="description" value="Descrição: " />
                <p:inputTextarea id="description" rows="6" cols="33" value="#{createProduct.product.description}" required="false" maxlength="256"/>

            </h:panelGrid>
        </p:panel>

        <p:toolbar>
            <f:facet name="right">
                <p:commandButton value="Submit" action="#{createProduct.save}" update=":create-form table-form @parent" style="margin-right:20px;"/>
            </f:facet>
        </p:toolbar>
    </h:form>



    <h:form id="table-form" class="center">
        <p:commandButton icon="ui-icon-arrowrefresh-1-e" action="#{detailsProduct.init()}" update="table-form" styleClass="update-table"/>

        <p:growl id="msgs" showDetail="true"/>

        <p:dataTable id="products" var="p" value="#{detailsProduct.list}" style="margin-bottom:20px"
                     paginator="true" rows="10" paginatorPosition="bottom">
            <f:facet name="header">
                <h:outputText value="Produtos"/>
            </f:facet>

            <p:column headerText="ID">
                <h:outputText value="#{p.entityID}"/>
            </p:column>

            <p:column headerText="Desconto">
                <h:outputText value="#{p.discount}">
                    <f:convertNumber type="percent"/>
                </h:outputText>
            </p:column>

            <p:column headerText="IVA">
                <h:outputText value="#{p.iva}">
                    <f:convertNumber type="percent"/>
                </h:outputText>
            </p:column>

            <p:column headerText="PVP">
                <h:outputText value="#{p.pvp}">
                    <f:convertNumber currencySymbol="€" type="currency"/>
                </h:outputText>
            </p:column>

            <p:column headerText="Descrição">
                    <h:outputText value="#{p.description}" style="width: 100%; height: fit-content"/>
            </p:column>

            <p:column headerText="Prateleiras">
                <p:dataList value="#{p.shelves}" var="s" converter="omnifaces.SelectItemsIndexConverter">
                    #{s.entityID}
                </p:dataList>
            </p:column>

            <p:column style="width: 70px" headerText="Remover">
                <p:commandButton icon="ui-icon-close" title="Remover" action="#{detailsProduct.delete(p.entityID)}" update="table-form:msgs :table-form">
                    <p:confirm header="Confirmação" message="Deseja remover o produto?" icon="ui-icon-alert"/>
                </p:commandButton>

                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                    <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                    <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
                </p:confirmDialog>
            </p:column>
        </p:dataTable>
    </h:form>

</h:body>
</html>